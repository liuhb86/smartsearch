<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="content-type">
<title>BiLSearch</title>
<script src="http://code.jquery.com/jquery-1.8.3.min.js" type="text/javascript">
</script>
<script src="jquery.query-2.1.7.js"></script>
<style>
body, div {
	overflow: hidden;
	margin: 0;
	padding: 0;
}
#resultFrame {
	width: 100%;
	border: none;
	margin: 0;
	padding: 0;
}
#searchBar {
	padding: 5px;
	width : 100%;
	position: absolute;
	background-color: rgba(50,50,50,.5);
}
</style>
</head>
<body>
	<div id="searchBar">
		<input type="text" id="queryInput"></input>
		<button id="searchButton">Search</button>
		<span id="searchEngines">
		</span>
	</div>
	<iframe id="resultFrame">
	</iframe>
</body>
<script type="text/javascript">

(function() {
var self = window.smartSearch = {
	config : {
	},
	runtime : {
	},
	searchEngines : {
		baidu : {
			icon : "",
			title : "Baidu",
			url : "http://www.baidu.com/s?ie=utf-8&wd="
		},
		bing : {
			icon : "",
			title : "Bing",
			url : "http://www.bing.com/search?q="
		},
		google : {
			icon : "",
			title : "Google",
			url : "http://www.google.com/custom?ie=utf-8&q="		
		}
	},
	doSearch : function (query) {
		var i, strEngine, navUrl,
			isPureAscii = true;		
		for (i = 0; i < query.length; ++i) {
			if (query.charCodeAt(i) > 127) {
				isPureAscii = false;
				break;			
			}
		}
		strEngine = isPureAscii ? "google" : "baidu";
		navUrl = self.searchEngines[strEngine].url + query;
		self.doNavigate(navUrl, query);
	},
	doNavigate : function (url, query) {
		self.view.setFrameUrl(url);
		self.view.setTitle(query);
		self.view.setUrlHash(query);
	},
	view : {
		setFrameUrl : function (url) { $("#resultFrame")[0].src = url; },
		setTitle : function (query) { window.title = query + " - BiLSearch"; },
		setUrlHash : function (hash) { window.location.hash = hash; },
		onSearch : function () {
			var query = $("#queryInput").val();
				self.doSearch(query);
		},
		onResize : function () {
			$("#resultFrame").height(window.innerHeight);	
		},
		bindEvents : function () {
			$("#searchButton").click(self.view.onSearch);
			$("#queryInput").keypress(function (event) {
				if	(event.which == 13) {
					self.view.onSearch();	
				}
			});
			$(window).resize(self.view.onResize);
		},
		init : function () {
			var query;
			self.view.onResize();
			self.view.bindEvents();
			if (window.location.hash && window.location.hash.length > 1) {
				query = window.location.hash.substr(1);
			} else {
				query = $.query.get("q");
			}
			self.runtime.query = query;
			$("#queryInput").val(self.runtime.query);
		}
	},
	init : function () {
		var query;
		query = 
		self.view.init();
		if (self.runtime.query) {
			self.doSearch(self.runtime.query);
		}
	}
}
})();


$(function (){
	smartSearch.init();
});
</script>
</html>
